2006-03-13  Martin Mares  <mj@ucw.cz>

	* update-pciids.sh: Use curl if available. Patch by Matthew Wilcox.

2006-01-04  Martin Mares  <mj@ucw.cz>

	* lspci.c (show_express_link): Fixed decoding of link status register.
	Thanks to Roland Dreier for his report.

2005-12-12  Martin Mares  <mj@ucw.cz>

	* lib/nbsd-libpci.c: If libpci is used by an ordinary user, allow
	at least read-only access. Patch by Pavel Celeda <celeda@liberouter.org>.

	* Makefile: Corrected library path on NetBSD.

2005-11-26  Martin Mares  <mj@ucw.cz>

	* Released as 2.2.1.

	* lspci.c (show_machine): Subsystem vendors were printed incorrectly
	in machine-readable modes. Thanks to Pavel Celeda for a bug report.

2005-10-11  Martin Mares  <mj@ucw.cz>

	* lspci.c (new_bus): Fixed a memory leak. Thanks to Paul Sangree for reporting it.

2005-09-21  Martin Mares  <mj@ucw.cz>

	* Released as 2.2.0.

	* pci.ids: Updated copyright header.

	* lib/sysfs.c (sysfs_get_resources): Removed warning about unsupported
	64-bit addresses, they are now always supported.

	* lspci.c (show_bases): Corrected printing of 64-bit addresses
	in bus-centric mode.

	* lib/configure: Enable 64-bit addresses on all Linux systems.

	* lib/types.h: Don't pad 64-bit addresses to 16 xigits, only to 8 if they
	are shorter.

2005-09-11  Martin Mares  <mj@ucw.cz>

	* Released as 2.1.99-test11.

	* lspci.c: Removed unnecessary trailing zeros in pci_lookup_name() calls.

2005-09-10  Martin Mares  <mj@ucw.cz>

	* Released as 2.1.99-test10.

	* pci.ids: Synchronized with the current database snapshot.

	* update-pciids.sh: Changed the default URL for downloading pci.ids
	to http://pciids.sourceforge.net/v2.2/pci.ids.

	* lib/pci.h (PCI_LIB_VERSION): Added version identifier.

	* lib/names.c: Rewritten the name database module almost from scratch.
	Everything is much cleaner and there are hopefully no more memory leaks;
	pci_lookup_name() now uses varargs in a backward compatible fashion.
	Introduced PCI_LOOKUP_NO_NUMBERS.

	The new code supports subsystem entries not tied to a specific device.
	I had to extend the format of pci.ids in order to support it, so I have
	extended the idea of the "C" (class) blocks and introduced "S" blocks
	for subsystems. To avoid doing more incompatible changes in the future,
	the parser skips unknown single-letter blocks without reporting errors.

2005-08-23  Martin Mares  <mj@ucw.cz>

	* Released as 2.1.99-test9.

	* Makefile (OPT): Removed -fomit-frame-pointer, it's default in recent
	gcc versions when optimizing anyway.

	* Made the path to pci.ids customizable and independent on the SHAREDIR.
	Just override IDSDIR in the top-level Makefile.

	* pci.ids: Synchronized with the current database snapshot.

	* lspci.man, setpci.man: Improved the man pages. Documented all access
	methods and which operations are privileged.

	* lspci.c: Another rewrite of config register caching, now also including
	lots of internal checks. It should be now perfectly able to cope with
	portions of the configuration space being inaccessible, for example
	due to insufficient access rights.

	* lspci.c (show_pcix_nobridge, show_pcix_bridge): Cleaned up dumping of PCI-X
	capabilities. Includes partial support for PCI-X 2.0 (probably incomplete
	as I haven't seen the spec).

	* lspci.c: Quell warnings about unused parameters.

	* lspci.c: Removed C++ comments.

	* lib/header.h: Merged definitions of extended capabilities and some new
	PCI-X capability bits from linux-2.6.11/include/pci.h.

	* lspci.c (show_caps): Try to scan extended capabilities only if the
	device has either PCI-X or PCI Express capability in its normal capability
	list.

	* lib/dump.c (dump_init): Reading of dumps works again. The dump reader
	now also remembers how much data it has read and refuses attempts to
	access more than that.

	* setpci.man, lspci.c, README: prefer spelling "buses" over "busses".

	* lspci.c: If alloca() is not available, use xmalloc(), not malloc().

	* lib/configure: Added x86_64 on Linux.

2005-08-22  Martin Mares  <mj@ucw.cz>

	* lib/filter.c (pci_filter_parse_slot): Fixed parsing of domain filters.
	Thanks to Matthew Wilcox for bug report.

	* lspci.c: Corrected spelling of "Hz" (it was "hz" at several places).
	Thanks to Krzysztof Oledzki for pointing that out.

2004-08-19  Martin Mares  <mj@ucw.cz>

	* pciutils.spec (%attr): Setting attributes for /sbin/* is an anachronism,
	because pciutils by default install to /usr/sbin. Update.

2004-08-13  Martin Mares  <mj@ucw.cz>

	* Released as 2.1.99-test8.

	* lib/types.h, lib/pci.h, lib/sysdep.h: `byte' and `word' are
	no longer exported to the outside world.

	* README.Windows: Updated.

	* maint/release: Substitute version number in win32/config.h.

	* win32/config.h: Added.

	* lib/sysdep.h (bzero, strcasecmp): are macros on Windows.

	* compat/getopt.[ch]: Added copies of getopt.[ch] from the GNU
	C library for use on systems where the default libraries lack
	proper getopt. Currently used by the Windows port.

	* lib/sysdep.h, lib/types.h: Updates of the Windows port from
	Alexander Stock.

	* lib/types.h: If PCI_HAVE_Uxx_TYPES is defined, libpci doesn't define
	its own u8, u16, u32, byte and word types and uses what the user
	has supplied instead. With this change, all namespace clashes should
	be gone.

	* Makefile, lib/Makefile: Updated dependencies.

	* pciutils.h: Include lib/sysdep.h and move NONRET et al. there.

	* lib/sysdep.h: No need to include <sys/types.h> on FreeBSD, because
	it is included unconditionally in lib/types.h.

	* Moved system-dependent stuff from lib/internal.h to lib/sysdep.h,
	which is also used by the utilities. Also moved type declarations
	from lib/pci.h to lib/types.h.

	* All files: Prepend a "PCI_" prefix in front of all configuration
	defines to avoid namespace clashes. CAVEAT: If there is any libpci
	application using the (undocumented) defines, it has to be updated.

	* lib/Makefile: Killed HAVE_OWN_HEADER_H, since we stopped sharing
	headers with the kernel a couple of years ago.

	* lib/sysfs.c (sysfs_get_resources): We have 7 resources, not 6.

	* lspci.c (show_rom): Use the same logic for printing disabled
	or unassigned ROM's as we do in show_bases() for the other BAR's.

	* lib/generic.c (pci_generic_fill_info): Better reaction to
	invalid 64-bit addresses. Also d->hdrtype should not include
	bit 7, which caused mysterious errors on multi-function devices.

	* lib/generic.c (pci_generic_fill_info): Fill in base addresses
	even if the regions are known to be disabled. It is the client's
	job to interpret them. (And it is not a trivial job if you want
	to do it correctly, since you need to check I/O and memory enables
	on all upstream bridges, too.) However, it could be interesting to
	introduce functions for interpreting the addresses and even for
	mapping the regions and doing I/O on them.

2004-07-30  Martin Mares  <mj@ucw.cz>

	* lspci.c: HyperTransport improvements from Maciej.

2004-07-11  Martin Mares  <mj@ucw.cz>

	* lib/sysfs.c (sysfs_get_resources): Arguments now correspond
	to the format string. [Patch by Bill Nottingham]

2004-07-05  Martin Mares  <mj@ucw.cz>

	* Released as 2.1.99-test7.

	* lspci.c (config_fetch): Wanted to merge Matthew's bug fix, but
	ended up with rewriting the fetching mechanism to be fully dynamic,
	but avoid reading config space registers not explicitly requested.

2004-06-29  Matthew Wilcox <willy@debian.org>

	* lspci.c: More work on PCI Express dumping.

	* lib/header.h: Updated PCI Express capability definitions.

	* lib/proc.c (proc_read): Removed bogus warning.

	* common.c (xrealloc): Introduced.

	* lspci.man: Added -xxxx.

2004-06-27  Martin Mares  <mj@ucw.cz>

	* Released as 2.1.99-test6.

	* lspci.c (show_msix), lib/header.h: Added dumping of MSI-X cap.
	Patch by Roland Dreier <roland@topspin.com>, cleaned up by me.

	* lspci.c (show_pcix_nobridge, show_pcix_bridge): Handle config_fetch()
	failures.

	* lib/header.h: Added PCI Express extended capabilities. Again by Matthew.

	* lspci.c (show_express): Added dumping of PCI Express cap.
	Patch by Matthew Wilcox.

	* lib/header.h: Added a list of PCI 3.0 capabilities and also details
	on PCI Express caps. Patch by Matthew Wilcox <willy@debian.org>.

	* lspci.c (check_root): Gone. No explicit checks for root are needed,
	report correct errors reported by the libpci instead.

	* lspci.c: Added dumping of the extended config space on "-xxxx".
	Better caching of config registers.

	* setpci.c (main): Allow access to whole 4096 bytes of the config space.

	* lib/sysfs.c, lib/proc.c: Don't print error messages on short reads,
	just return the appropriate error code.

	* lib: Added support for extended (4096-byte) configuration space,
	currently implemented only in Linux proc and sysfs access methods
	and of course in the dump reader.

2004-05-29  Martin Mares  <mj@ucw.cz>

	* Released as 2.1.99-test5.

	* lib/pci.h: Windows don't have the standard u_int* types.

	* lib/internal.h: <sys/param.h> required on Windows for endianity
	macros.

	* lib/i386-ports.c: Connected i386-io-windows.h.

	* lspci.c (check_root): geteuid() is not available on Windows.

	* lib/i386-io-windows.h: Added Windows port contributed by Alexander
	Stock <stock.alexander@gmx.de>.

	* lib/configure: Hopefully fixed SunOS port broken by various
	changes to the configure script.

	* Makefile, lib/configure: Cross-compilation support, patch by Maciej.

2004-05-28  Martin Mares  <mj@ucw.cz>

	* Released as 2.1.99-test4.

	* lspci.c (show_verbose): Header type 1 is probably legal for all
	types of bridges, not only for PCI-to-PCI bridges.

	* lspci.c (format_agp_rate): Write "x16", not "x@".
	(show_agp): rate[] could overflow.
	Bugs reported by Jakub Bogusz <qboosh@pld-linux.org>.

	* lspci.c (show_ht_*): Show HyperTransport capability with all its
	details. Once again code by Maciej simplified (i.e., possibly broken)
	by me.

	* lib/header.h: Added declarations of HyperTransport capability.
	Again thanks to Maciej.

	* lspci.c: Decode all bits of the secondary status word in type 1 headers.
	Thanks to Maciej W. Rozycki <macro@ds2.pg.gda.pl> for the patch.

2003-12-27  Martin Mares  <mj@ucw.cz>

	* Released as 2.1.99-test3.

	* lspci.man, setpci.man: Document domains and correct spelling.

	* lib/dump.c (dump_init): Added ability to read domain numbers.

	* lspci.c: Devices in domains different from 0 have their slot number
	printed as "<domain>:<bus>:<slot>.<func>". Tree view supports domains
	as well.

	* lib/filter.c: Slot filters understand domains.

	* lib/generic.c: Mention the domain in slot numbers in all error messages.

	* lib/internal.h: The #ifdef for Linux <asm/byteorder.h> was wrong.

	* lib/access.c (pci_get_dev): Added support for domains.

	* lib/sysfs.c (sysfs_scan): Read vendor and device ID from the config
	registers (or to be precise, leave it for the generic parts of the pcilib
	to do so) instead of reading them from the sysfs. It's faster this way.

	* lspci.c (show_pcix): Don't touch pci_dev->hdrtype, it's an internal
	variable. Better read it from the config registers (it's cached anyway).

	* lib/sysfs.c (sysfs_scan), lib/proc.c (proc_scan): Don't read the hdrtype.
	  lib/generic.c (pci_generic_fill_info): If hdrtype is -1 (unset), read it.
	  Saves lots of unnecessary file accesses.

	* lib/pci.h (PCIADDR_PORT_FMT): Use %llx instead of %Lx, because the latter
	is not supported by all C libraries.

	* Makefile: Always enter the lib directory (remember that we don't have
	full dependecies for the library in the top-level Makefile; hmmm, another
	thing to rewrite some day).

	* lib/sysfs.c: Added Linux sysfs access method based on the patch
	written by Matthew Wilcox <willy@fc.hp.com>.

	* lib/proc.c: Renamed the access method name from "/proc/bus/pci" to "Linux-proc".

	* lib/pread.h: The hacks to support pread on various versions
	of Linux libc moved there.

	* lib/proc.c (proc_setup): The return value of snprintf() varies
	between glibc versions, so we need to check both for a negative
	values and for too large values.

	* Removed last few references to the "Linux PCI Utilities", the
	package is pretty cross-platform now :)

2003-12-27  Martin Mares  <mj@ucw.cz>

	* Released as 2.1.99-test2.

	* README, pciutils.lsm, pciutils.spec: Use @VERSION@ to make the
	release scripts insert the current version. "make release" is gone.

	* maint/release, maint/release.pm: Added a new system of scripts for
	making releases including inter-version diffs etc.

	* Makefile: Cleaned up.

	* lib/fbsd-device.c: I patched another copy of this file by mistake,
	this time the version checks should be right.

2003-12-27  Martin Mares  <mj@ucw.cz>

	* Released as 2.1.99-test1.

	* pciutils.h, common.c, lspci.man, setpci.man, lib/internal.h:
	Remove shadows of the syscall access method which was never
	implemented.

	* update-pciids.sh: Try to preserve permissions of the old file
	if chmod supports --reference. Should close Debian Bug #223740.

	* lib/proc.c (proc_setup): Increased path name length limit to 1024.
	Thanks for Redhat and Mandrake for inspiration.

	* lib/configure: Recognize ppc and ppc64, both have 64-bit addresses.
	Grabbed from Redhat (Fedora) patches.

2003-12-27  Martin Mares  <mj@ucw.cz>

	Merged bug fixes from Debian patches:

	* lspci.c (show_verbose): "Cache Line Size" should be capitalized.

	* lspci.c (show_pcix_nobridge): Added a missing newline.

	* lib/proc.c (proc_scan): When reading the header type, don't
	forget to clear the topmost bit indicating that the device has
	multiple functions.

2003-12-27  Martin Mares  <mj@ucw.cz>

	Updated the FreeBSD port. Thanks to Samy Al Bahra <samy@kerneled.com>
	for the patches:

	* lib/Makefile: Add ${FREEBSD_SYS} to the include path if it's defined.
	* lib/fbsd-device.c: Select the right set of system includes according
	to __FreeBSD_version.

2003-12-27  Martin Mares  <mj@ucw.cz>

	Merged support for Solaris on i386 by Bill Moore <billm@eng.sun.com>
	and cleaned up:

	* lib/configure: Recognize SunOS.
	* lib/internal.h: Learn how to recognize byte order on SunOS.
	* lib/i386-ports.c: Split OS-dependent I/O port access from i386-ports.c.
	* lib/i386-io-linux.h: Linux specific part.
	* lib/i386-io-hurd.h: GNU/Hurd specific part.
	* lib/i386-io-sunos.h: SunOS specific part.

2003-12-26  Martin Mares  <mj@ucw.cz>

	* lib/header.h (PCI_*_MASK): Cast to pciaddr_t explicitly.

	* lib/pci.h: Types declared in <sys/types.h> should be usable on all
	platforms we currently support, so kill the forest of #ifdef's and
	use them in all cases.

	* lib/pci.h: Use ULONG_MASK to decide whether we should use long
	or long long to represent a 64-bit address. Killed HAVE_LONG_ADDRESS.
	Define format strings for addresses, port numbers and IRQ numbers
	directly in pci.h.

	* lib/proc.c (proc_scan): Use PCIADDR_T_FMT for scanf'ing addresses.

2003-12-26  Marco Gerards  <metgerards@student.han.nl>

	Added support for the GNU Hurd (cleaned up by Martin Mares):

	* lib/configure [GNU]: Use the i386 ports for configuration access.
	* lib/i386-ports.c: Don't call iopl() on the Hurd.
	* lib/pci.h [OS_GNU]: Include <sys/types.h> and use it for defining
	u8 to u32.

2003-12-26  Martin Mares  <mj@ucw.cz>

	* lspci.c (show_pcix_bridge, show_pcix_nobridge): Don't forget to call
	config_fetch() to ensure that the registers have been read. Thanks to
	Bill Wood <bill.wood@hp.com> for the patch.

	* lspci.c: Ensure that failure of config_fetch() is handled correctly
	at all places.

	* lspci.man: There was one more explicit reference to /usr/share/pci.ids.
	Changed to @SHAREDIR@. Patch from Maciej W. Rozycki <macro@ds2.pg.gda.pl>.

	* setpci.c (main): Better error messages.

	* setpci.c (ex_op): The demo mode should disable only writing, not reading.

	* setpci.man: The documentation was inconsistent on what should -D do.
	Document the new behaviour.

	* pciutils.h, common.c, setpci.c: Introduced a NONRET macro encapsulating
	the GCC specific __attribute__((noreturn)) and killed the hack with
	redefining __attribute__ on non-GCC compilers.

	* Makefile: Added missing dependencies. Parallel builds work now.
	Problem reported by Andreas Haumer <andreas@xss.co.at>, but I chose
	a different fix.

	* Makefile (MANDIR): Use `:=' instead of `=' to avoid executing the shell
	command every time $(MANDIR) is referenced.

	* lspci.c (main): The error message for `lspci -s' incorrectly mentioned
	a `-f' switch. Reported by Steve Finney <Steve.Finney@SpirentCom.COM>.

	* lib/generic.c: Removed memory leak in pci_generic_bus_scan().
	Reported by Gary Parnes <gary_parnes@terago.com>.

	* Replaced obsolete syntax of __attribute__((unused)) in the middle of
	parameter declarations (which is no longer supported by GCC 3.1) by the
	current syntax (attribute at the end). Thanks to pixel@mandrakesoft.com
	for reporting this problem.

	* Removed CVS $Id$ tags from all files.

	* Makefile: Added some more warnings.

	* setpci.c: Cleaned up mask/value code.

2003-12-08 Thayne Harbaugh <tharbaugh@lnxi.com>

	* setpci.c: Individual bits to be set can be specified as <value>:<mask>.

2003-11-29  Martin Mares  <mj@ucw.cz>

	* Imported the pciutils sources to my Arch repository. Good-bye, CVS.

2003-01-04  Martin Mares  <mj@ucw.cz>

	* Released as 2.1.11.

	* Makefile: Changed configuration of installation directories --
	all paths are now set at the top of the Makefile instead of being
	scattered between the installation rules. The default installation
	now goes always to /usr/local regardless of the OS as most distributions
	already contain some version of pciutils and we don't want custom
	installations to interfere with the default ones.

	* Makefile: Removed a couple of ancient install hacks: we no longer
	try to avoid overwriting a newer pci.ids file (users are now expected
	to use update-ids) and we don't try to remove /etc/pci.ids (a long time
	has passed since the last version which used it).

	* Makefile: Paths to pci.ids in man pages automatically get the right path.

	* Added the update-ids utility.

	* lib: Removed partially implemented "syscall" access method which will
	probably never be needed.

2002-12-27  Martin Mares  <mj@ucw.cz>

	* lib/nbsd-libpci.c: Cleaned up and hopefully made it endian safe.

	* lib/generic.c (pci_generic_scan_bus): Added work-around for devices with
	discontiguous numbering of functions. This is already present in the Linux
	kernel for several years, but I forgot to update pciutils as well.

2002-12-26  Martin Mares  <mj@ucw.cz>

	* lib/header.h, lspci.c: Dump AGP3 flags and speeds.

	* lib/pci.h, Makefile: Removed HAVE_OWN_HEADER_H. Always use our own header,
	there is no reason to prefer the kernel version.

	* lib/proc.c (proc_scan): Don't forget to initialize hdrtype.

	* Added preliminary version of NetBSD support by Quentin Garnier
	<netbsd@quatriemek.com>.

2002-04-06  Martin Mares  <mj@ucw.cz>

	* lspci.c: Mention "-xxx" in the help.

2002-03-30  Martin Mares  <mj@ucw.cz>

	* Released as 2.1.10.

	* Removed pci.ids from the CVS as they are now maintained separately.
	They are still included in the tarball, but if you are building	pciutils
	from CVS sources or you want to get a newer ID file than the one distributed,
	just use "make update-ids" to download the most recent snapshot from
	pciids.sf.net.

	* Makefile, README: Updated accordingly.

	* Makefile: Added a couple of maintenance targets.

	* maint/*: Maintainer's utilities now reside here (present only in CVS,
	not in the tarball).

	* lib/names.c (parse_name_list): End-of-line comments are no longer
	supported. Hashes are now perfectly valid in all names and they start
	a comment only at the start of the line.

2002-03-26  Martin Mares  <mj@ucw.cz>

	* README: Rewritten.

	* Makefile: When the currently installed pci.ids file is newer than
	the version to be installed, don't overwrite it. Suggested by
	Jean Delvare <khali@linux-fr.org>.

2002-03-24  Martin Mares  <mj@ucw.cz>

	* lspci.c (show_pcix_bridge): Added PCI-X capability display.
	Contributed by Jeff Garzik <jgarzik@mandrakesoft.com>.

	* lib/header.h: Added PCI-X stuff. Again by Jeff.

	* Makefile (CFLAGS): -Werror is gone.

	* lspci.c (format_agp_rate): Fixed AGP rate reporting.

	* lib/filter.c (pci_filter_parse_slot): Allow bus 0xff, slot 0x1f and
	function 7.

	* lib/names.c (pci_lookup_name): When printing unknown subsystem vendor
	or device hexadecimally, don't confuse it with chip vendor/device ID.
	First reported by Marc Boucher <marc@mbsi.ca>.

2001-11-04  Martin Mares  <mj@ucw.cz>

	* Released as 2.1.9.

	* pci.ids: Synced with the PCI ID Repository at SourceForge
	(http://pciids.sourceforge.net/).

2000-08-25  Martin Mares  <mj@albireo.ucw.cz>

	* pci.ids: Updated ID's, synced with kernel 2.4.0-test7.

2000-06-13  Martin Mares  <mj@albireo.ucw.cz>

	* Makefile (uninstall): Fixed.

	* pci.ids: ID updates.

2000-05-20  Martin Mares  <mj@albireo.ucw.cz>

	* Released as 2.1.8.

	* pci.ids: ID updates.

	* lspci.c (show_verbose): Min/max latency is now printed in nanoseconds.

2000-05-04  Martin Mares  <mj@albireo.ucw.cz>

	* lspci.c (show_verbose): If the header type doesn't match device
	class, just print a warning and still use the header type, assuming
	bogus class info.

2000-05-01  Martin Mares  <mj@albireo.ucw.cz>

	* lspci.c (show_pm): Updated according to PCI PM specs 1.1.

	* pci.ids: Updated Contemporary Control ARCnet card entries.

	* pci.ids: Synchronized class list with latest PCI SIG documents.

2000-04-29  Martin Mares  <mj@albireo.ucw.cz>

	* lib/names.c (pci_lookup_name): Fixed the cheat.

	* lib/internal.h: Moved UNUSED/inline hacks above all other declarations.

	* pci.ids: Various ID updates.

2000-04-21  Martin Mares  <mj@albireo.ucw.cz>

	* Released as 2.1.7.

	* pciutils.spec: Added German description.

	* lib/names.c (pci_lookup_name): Added a cheat for case that subsystem ID's
	are the same as device ID and just output subsystem name according to
	device name.

	* lib/proc.c: Use UNUSED instead of __attribute__((unused)).

	* lib/pci.h: Added the correct typedefs for AIX.

	* lib/generic.c (pci_generic_scan_bus): Export.

	* lib/configure: Detect AIX. Use "echo '...\c'" instead of
	"echo -n" if the shell isn't bash.

	* lspci.c: Avoid using alloca() if not compiled by GCC.
	(insert_dev): Avoid returning a void value.

	* Makefile: Choose which install utility to use according to
	OS type. Also use `-o' instead of `-or' in find arguments.
	Part of the AIX port.

	* lib/aix-device.c: Added AIX low-level interface. Contributed
	by Dave Johnson <ddj@brown.edu>, thanks a lot!

	* pci.ids: Few new ID's.

	* pciutils.h, lib/internal.h: Redefine __attribute__ and inline
	when not compiled by GCC.

2000-04-17  Martin Mares  <mj@albireo.ucw.cz>

	* Released as 2.1.6.

	* pci.ids: Added a large batch of ID's contributed by Gunther
	Mayer <gunther.mayer@braunschweig.netsurf.de> and synced the
	list with the 2.3.99pre6 kernel.

Thu Mar  9 13:11:39 2000  Martin Mares  <mj@albireo.ucw.cz>

	* lib/example.c: Added a simple example of how to use
	the library.

	* lspci.man, setpci.man: Revealed --version. Well spotted
	by Adam Sulmicki.

	* pci.ids: Added lots of new ID's and synced with 2.3.50.

Tue Feb 15 00:16:21 2000  Martin Mares  <mj@albireo.ucw.cz>

	* Released as 2.1.5.

	* pciutils.spec: Updated spec file from Andreas Jaeger. Now using
	%{_mandir} to find the right location to install manual pages to.

	* pci.ids: New ID's.

	* setpci.c (main): Don't crash when `-s' or `-d' is given with
	no argument.

Mon Jan 24 20:04:11 2000  Andreas Jaeger  <aj@suse.de>

	* lib/i386-ports.c: Include <asm/io.h> only on systems without
	glibc.

Mon Jan 24 11:24:43 2000  Martin Mares  <mj@albireo.ucw.cz>

	* Makefile: Modified to work with the Linux FHS brain-damaged idea
	of putting man pages to /usr/share/man. Now we choose either /usr/man
	or /usr/share/man depending on which one exists.

Sun Jan 23 10:52:34 2000  Martin Mares  <mj@albireo.ucw.cz>

	* pci.ids: Synced with Linux 2.3.40.

	* Released as version 2.1.4.

Thu Jan 20 11:08:32 2000  Martin Mares  <mj@albireo.ucw.cz>

	* lspci.c (scan_device): Fixed bug in reading of cardbus extensions.

	* lib/proc.c: pread/pwrite fixed again, this time on libc5 :(

	* lspci.c (format_agp_rate): Better formatting of AGP rates.

	* pci.ids: New ID's.

	* lib/configure: Added configuration for ia64 (the same as for Alpha).
	Patch from Stephane Eranian <eranian@cello.hpl.hp.com>.

Thu Jan 13 23:01:52 2000  Martin Mares  <mj@albireo.ucw.cz>

	* Released as version 2.1.3.

	* pci.ids: New ID's.

	* lspci.c: Alpha IO_FORMAT fix by Andrea Arcangeli.

	* lib/access.c: Corrected order of access methods -- it's wonderful how
	long could such a bug remain unspotted. Thanks go to Andreas Schockenhoff.

Sat Dec 11 23:34:48 1999  Martin Mares  <mj@albireo.ucw.cz>

	* Released as version 2.1.2.

	* lib/names.c (pci_lookup_name): Fixed printing of unknown subsystem ID's.

Sat Dec  4 13:11:03 1999  Martin Mares  <mj@albireo.ucw.cz>

	* Released as version 2.1.1.

	* pci.ids: Several new ID's.

	* setpci.c (exec_op): Don't forget to increment address after writing
	single value, so that `30.b=12,34,56,78' works as expected. Reported
	by Petr Soucek <petr@ryston.cz>.

Wed Nov  3 10:24:38 1999  Martin Mares  <mj@albireo.ucw.cz>

	* lspci.c (show_terse): If prog-if is zero, but it's present in the
	ID list, show it.

Sat Oct 30 11:06:35 1999  Martin Mares  <mj@albireo.ucw.cz>

	* Released as version 2.1.

	* pci.ids: Synced to devlist.h in 2.3.24 kernel. Merged in
	lots of contributed entries.

Thu Oct 14 10:40:12 1999  Dave Jones    <dave@powertweak.com>

	* pci.ids: Added lots of subsystem definitions.

Sat Oct  9 14:32:28 1999  Martin Mares  <mj@albireo.ucw.cz>

	* setpci.man: Better example.

	* lspci.c: Resolve prog-if names.

	* lib/names.c: Adapted to new pci.ids syntax.

	* pci.ids: Reorganized the pci.ids file. Subsystems are listed
	under devices, classes can optionally contain prog-if information.
	New ID's, as usually.

Wed Sep 22 09:45:24 1999  Martin Mares  <mj@albireo.ucw.cz>

	* pci.ids: New ID's. As usually.

	* lspci.c (show_htype1, show_htype2): Don't show `closed' bridge windows
	unless we're vvvery verbose.

Mon Sep 20 11:22:54 1999  Martin Mares  <mj@albireo.ucw.cz>

	* lspci.c (show_htype2): Don't forget a TAB before the "I/O window" line.

Tue Sep 14 09:31:01 1999  Martin Mares  <mj@albireo.ucw.cz>

	* pci.ids: New ID's. Again.

Thu Aug  5 17:45:42 1999  Martin Mares  <mj@albireo.ucw.cz>

	* lspci.c (show_size): Don't show size if it's zero (usually
	due to bus-centric mode being enabled).

Tue Jul 20 13:25:09 1999  Martin Mares  <mj@albireo.ucw.cz>

	* lib/pci.h: Types are OS dependent.

	* lib/internal.h: Byte order hacks are OS dependent.

	* lib/configure: Recognize FreeBSD. Also set OS_XXX according to the OS.

	* lib/Makefile, lib/access.c: Added fbsd-device target.

	* pci.ids: Added an entry for PLX 9080 bridges with subsystem ID
	incorrectly set to device ID.

	* README: Added a note that we support FreeBSD.

	* Makefile (PREFIX, ROOT): Set it depending on the OS.
	(%.8): Grrr, BSD date is not able to convert date formats the same way
	as GNU date does. Use sed instead.
	(install): Use `-c' when calling install.

	* lib/fbsd-device.c: Added FreeBSD /dev/pci access module contributed
	by Jari Kirma <kirma@cs.hut.fi>.

	* lib/proc.c: Rewrote the pread/pwrite things once again. Use pread
	and pwrite only when we are certain it's safe (i.e., glibc 2.1
	on all architectures or any libc on a i386 where we really know
	how to use syscalls directly). In all other cases, emulate it
	with lseek/read/write.

	* pci.ids: Some more IDs.

Mon Jul 19 14:10:36 1999  Martin Mares  <mj@albireo.ucw.cz>

	* pci.ids: Added IDs of parallel port controller cards as sent
	by Tim Waugh <tim@cyberelk.demon.co.uk>.

Wed Jul  7 00:55:48 1999  Martin Mares  <mj@albireo.ucw.cz>

	* lib/proc.c (proc_scan): HAVE_LONG_ADDRESS instead of HAVE_64BIT_ADDRESS.

	* lspci.c: ADDR_FORMAT now depends on both HAVE_64BIT_ADDRESS and
	HAVE_LONG_ADDRESS.

	* lib/configure: HAVE_64BIT_ADDRESS now doesn't imply that the addresses
	are represented as long long. Introduced a new flag HAVE_LONG_ADDRESS
	to indicate this. Both Sparc architectures now use both 64BIT_ADDRESS
	and LONG_ADDRESS since they have 32-bit userland, but don't set LONG_ADDRESS
	on Alpha.

	* lspci.c (show_msi): Added dumping of the MSI capability.
	(show_slotid): The same for SlotID capability.
	(show_caps): Seperated capability dumping, because it should
	be used for both htype0 and htype1. Even PCI 2.2 doesn't mention
	layout of htype2, so I'm a bit unsure about it wrt capabilities
	-- they at least have to live somewhere else since address 0x34
	is already defined differently in htype2.

	* lib/header.h (PCI_STATUS_UDF): Marked as obsolete (PCI 2.2).
	(PCI_BASE_ADDRESS_MEM_TYPE_1M): Ditto.
	(PCI_CAP_ID_*): Added some new capabilities defined in PCI 2.2.

	* lspci.c (show_htype0): Mask out lowest 2 bits from all capability pointers
	(required by the PCI 2.2 specs).

Mon Jul  5 12:45:19 1999  Martin Mares  <mj@albireo.ucw.cz>

	* lspci.c (show_size): Added new function for dumping of region sizes.
	(show_rom): Added. Now correctly dumps unassigned ROM addresses, disabled
	ROMs et cetera.

	* lib/pci.h (struct pci_dev): known_fields moved to the public part
	of the structure.

	* Added support for region sizes. Needs support in the kernel, because
	sizes have to be scanned before drivers initialize yourself. pci_fill_info()
	now returns a bitmask of what fields were really read.

Mon Jun 28 18:37:51 1999  Dave Jones    <dave@powertweak.com>

	* Makefile:
	  Added `uninstall' target - removes all traces of pciutils.
	* pci.ids:
	  - Lots of cleanups in the ATI, S3, Adaptec vendors.
	  - Changed Compaq QVision 1280/p definitions, as it's not possible
	    to determine the revision from the device ID.
	  - Same for the Tseng ET4000.
	    The id's said I had a rev C, when it was actually a rev B.
	  - Removed some unnecessary strings
	    `PCI'. Unless it's an AGP card, it should be obvious that it's PCI.
	    `Ethernet card'. This should be determined from config space.
	  - Lots of other new vendors & devices
	  - Other additional small cleanups.

Mon Jun 21 22:11:10 1999  Martin Mares  <mj@albireo.ucw.cz>

	* lib/names.c (pci_lookup_name): When device ID lookup
	fails, return hexadecimal device ID instead of vendor ID.
	Well spotted by Axel Bodemann <Axel.Bodemann@ruhr-uni-bochum.de>,
	I've just extended the fix to subsystem ID's.

Thu Jun 17 19:48:21 1999  Martin Mares  <mj@albireo.ucw.cz>

	* lspci.c (show_agp): Bug fix from Petr Vandrovec
	<vandrove@vc.cvut.cz>. The command register was displayed
	incorrectly.

Wed Jun  2 22:42:44 1999  Martin Mares  <mj@albireo.ucw.cz>

	* lib/proc.c (SYS_pread, SYS_pwrite): Use hard-coded
	numbers if not supplied by the libc.

Wed May 19 13:24:39 1999  Martin Mares  <mj@albireo.ucw.cz>

	* Released the whole package as version 2.0.

Fri May 14 22:42:02 1999  Martin Mares  <mj@albireo.ucw.cz>

	* pci.ids: Added several new ID's contributed by people
	on the linux-pci list.

Mon Apr 19 15:21:08 1999  Jakub Jelinek  <jj@ultra.linux.cz>

	* lspci.c: Display I/O addresses correctly on sparc64.
	* lib/header.h: Ditto.

	* lib/configure: On sparc set HAVE_64BIT* as well, we want
	a binary which works on both 32bit and 64bit SPARCs.

Sun Apr 18 21:14:58 1999  Martin Mares  <mj@albireo.ucw.cz>

	* lspci.c, lib/proc.c: Alpha compilation fixes from Matthew Jacob
	<mjacob@feral.com>.

	* pci.ids: A lot of updates from Adam J. Richter <adam@yggdrasil.com>.

Sun Feb 28 22:26:21 1999  Martin Mares  <mj@albireo.ucw.cz>

	* lspci.c (do_map_bus): Don't dump functions 1--7 if not flagged
	as a multi-function device, because several single-function devices
	don't decode the function bits at all.

Sun Feb 14 23:48:22 1999  Martin Mares  <mj@albireo.ucw.cz>

	* Makefile (install): Don't use "-o root -g root" for installation
	since it breaks on machines where programs are not installed by root.
	Reported by Richard Gooch <rgooch@atnf.csiro.au>

Tue Feb  9 15:54:39 1999  Martin Mares  <mj@albireo.ucw.cz>

	* lspci.c (show_bases): Use new address masking macros and pciaddr_t.

	* lib/pci.h: Using pciaddr_t for bus addresses, which are 32-bit
	or 64-bit depending on CPU.

	* lib/pci.h (PCI_ADDR_MEM_MASK): Added macros for address masks
	according to bus address width.

Thu Jan 28 20:54:16 1999  Martin Mares  <mj@albireo.ucw.cz>

	* Released as 1.99.4.

	* lspci.c: Capability list parser now recognizes both AGP
	registers and PCI Power Management registers (the latter
	is mainly guesswork based on DEC/Intel 21153 bridge specs
	since I don't have the PCI Power Management document).

	* lspci.c: Replaced numerous occurences of (x & flag) ? '+' : '-'
	by FLAG macro.

	* lspci.c: Added bridge checks to bus mapping code.

Wed Jan 27 14:59:16 1999  Martin Mares  <mj@albireo.ucw.cz>

	* lspci.c: Implemented bus mapping mode (-M).

	* lspci.c (scan_devices): Split to scan_devices() and scan_device().
	(show): Split to show() and show_device().

	* lib/access.c (pci_init): When a->method == PCI_ACCESS_AUTO,
	set it to the real access method afterwards.

Mon Jan 25 23:46:13 1999  Martin Mares  <mj@albireo.ucw.cz>

	* lib/generic.c (pci_generic_fill_info): If in buscentric mode,
	don't check PCI_COMMAND for I/O and memory enables.

Mon Jan 25 21:28:49 1999  Martin Mares  <mj@albireo.ucw.cz>

	* Makefile: Added target `release' which substitutes new version
	number to .spec, .lsm and README. Also rewrote target `dist'.

	* Released as 1.99.3.

Sun Jan 24 22:10:36 1999  Martin Mares  <mj@albireo.ucw.cz>

	* lib/header.h: Until kernel adopts new layout of PCI
	includes (i.e., separate declaration of header structure,
	functions and device IDs), which is not going to happen
	before 2.3, we'll use our own definiton of the header.

	* lspci.c (show_verbose): Display `Cap' flag in device status.

	* lspci.c (show_htype0): Display capability lists whereever
	available. The only capability name we recognize now is `AGP'.
	Unfortunately, capabilities are stored in device-dependent
	portion of the configuration space and are thus available
	only to root unless you read a dump.

	* lspci.c (scan_devices): Use cache instead of buffering.

	* lib/buffer.c: Removed (obsoleted by the cache).

	* lib/access.c: Added general caching mechanism.

Sat Jan 23 21:30:54 1999  Martin Mares  <mj@albireo.ucw.cz>

	* pci.ids: Added few devices.

Fri Jan 22 19:29:31 1999  Martin Mares  <mj@albireo.ucw.cz>

	* Version string is now defined in top-level Makefile, exported
	to the configure script and also substituted to man pages.

	* lspci.c (show_bases): Rewrote displaying of 64-bit addresses.
	(show_verbose): Rewrote interrupt display logic.

	* lib/i386-ports.c: Include sys/io.h only on glibc systems.

	* lib/configure: Rewrote detection of Linux versions. Now it
	works on 2.0 kernels (only with direct/dump access, of course).

	* lib/internal.h: New bytesex macros using <asm/byteorder.h>
	whenever available.

	* lib/proc.c (proc_read, proc_write): Distinguish between short
	read/write and real errors.

	* lspci.c (show_htype{0,1}): Always use d->dev->rom_base_addr since
	libpci respects buscentric mode automatically.

	* lspci.c (show_hex_dump): For CardBus bridges, print out 128
	bytes of header (the whole standard part).

	* common.c: pcilib options are now all uppercase. Also moved
	PCI access debugging option here.

	* Released as 1.99.2.

Wed Jan 20 22:50:35 1999  Martin Mares  <mj@albireo.ucw.cz>

	* Wrote configure script and rewrote Makefiles.

	* Removed few unused variables.

Wed Jan 20 12:21:56 1999  Martin Mares  <mj@albireo.ucw.cz>

	* common.c: Moved several functions used in both setpci and lspci
	here. This includes parsing of libpci-related options.

	* More library tweaks.

	* filter.c, names.c: Moved to library.

	* setpci: Rewritten to use the library.

	* Released as 1.99.1.

Tue Jan 19 23:00:12 1999  Martin Mares  <mj@albireo.ucw.cz>

	* lspci.c (scan_devices): For cardbus bridges, read first 128
	bytes of config space to get full standard header.

	* Makefile (CFLAGS): Removed "-Wno-unused".

	* Started the "New Generation" branch and introduced the
	PCI library.
	
	* lspci: Rewritten to use the library.

Tue Jan 19 22:24:08 1999  Martin Mares  <mj@albireo.ucw.cz>

	* Released as version 1.10.

Mon Jan 18 08:51:17 1999  Martin Mares  <mj@albireo.ucw.cz>

	* lspci.8, setpci.8: Miscellaneous fixes as suggested by
	Dag Wieers <dag@digibel.be>.

Sun Nov 29 20:05:56 1998  Martin Mares  <mj@albireo.ucw.cz>

	* pciutils.spec (Name): Update from Krzysztof G. Baranowski.

Sun Nov 22 10:49:56 1998  Martin Mares  <mj@albireo.ucw.cz>

	* Makefile, pciutils.h: Moved pci.ids to /usr/share.

	* Released as version 1.09.

Wed Nov 18 15:47:05 1998  Martin Mares  <mj@albireo.ucw.cz>

	* lspci.c (show_htype1): Fixed displaying of prefetchable memory behind
	bridge. Thanks to Petr Vandrovec <vandrove@vc.cvut.cz> for bug report.

Fri Oct 23 18:59:19 1998  Martin Mares  <mj@albireo.ucw.cz>

	* setpci.c: Don't include <syscall-list.h> with glibc >= 2.1.

Mon Oct 19 21:53:30 1998  Martin Mares  <mj@albireo.ucw.cz>

	* Released as version 1.08.

	* setpci.c: glibc 2.1.x already defines pread() and pwrite().

	* lspci.8: Changed warning about lspci -xxx.

	* lspci.c: Require "-xxx" for full configuration space dump, so that
	it's impossible to crash the machine by single typo.

	* specs: Added (courtesy of Krzysztof G. Baranowski <kgb@knm.org.pl>).

Wed Sep  9 12:03:24 1998  Martin Mares  <mj@albireo.ucw.cz>

	* lspci.c (show_bases): Better displaying of unassigned and
	disabled bases. Thanks to Gabriel Paubert <paubert@iram.es>
	for an idea.

Wed Sep  2 10:58:01 1998  Martin Mares  <mj@albireo.ucw.cz>

	* setpci.c (pread): Recognize glibc 1.99 numbered as 2.0 on the PPC.
	(thanks to Geert Uytterhoeven for finding this out)

Fri Jul 17 10:43:30 1998  Martin Mares  <mj@albireo.ucw.cz>

	* lspci.c (show_verbose): Print subsystem ID using the new resolver.
	(show_machine): Print subsystem ID.

	* names.c: New name resolution engine supporting subsystem IDs.

	* Released as version 1.07.

Wed Jul 15 15:37:21 1998  Martin Mares  <mj@albireo.ucw.cz>

	* lspci.c (show_htype2 etc.): Displaying of CardBus headers.
	(show_bases): Honor the `cnt' argument.
	(grow_tree): Parse CardBus headers in tree mode as well.

	* pci.h: Updated CardBus header field description. I still don't
	have the CardBus standard available, but OZ6832 specs contain
	full description of all header fields supported by the chip.

Tue Jun  9 22:53:59 1998  Martin Mares  <mj@albireo.ucw.cz>

	* Released as 1.06.

	* names.c (parse_name_list): Killed an unused variable.

	* setpci.c (pread, pwrite): Define SYS_(pread|pwrite) as __NR_\1
	if they are not defined by glibc (needed for glibc built on older
	kernels). Ugly.

	* setpci.c (exec_op): Fixed error messages. Thanks, Steve!

Mon Jun  8 10:59:22 1998  Martin Mares  <mj@albireo.ucw.cz>

	* Released as 1.05.

	* setpci.c: Problems with pread()/pwrite() with glibc on Alpha
	should be gone. Again thanks to Steve for bug report.

	* filter.c (filter_parse_slot): Fixed ":x" type filters.

	* pci.ids: Killed duplicate entry. Thanks to Stephen Williams
	<steve@icarus.com> for reporting this.

Sun Jun  7 19:27:51 1998  Martin Mares  <mj@albireo.ucw.cz>

	* lspci.c (main), setpci.c (main): Implemented "--version".

	* Released as 1.04.

	* pciutils.h (PCIUTILS_VERSION): Added version string.

	* filter.c, names.c: Extraneous #include <linux/pci.h> removed.
	Thanks to Geert Uytterhoeven <Geert.Uytterhoeven@cs.kuleuven.ac.be>
	for bug report.

Thu May 28 14:45:58 1998  Martin Mares  <mj@lomikel.karlin.mff.cuni.cz>

	* pci.ids: More updates from Jens Maurer.

Wed Apr 22 10:00:39 1998  Martin Mares  <mj@albireo.ucw.cz>

	* pci.ids: Updates from Jens Maurer.

Sun Apr 19 11:14:25 1998  Martin Mares  <mj@albireo.ucw.cz>

	* Released as 1.03.

	* setpci.8: Written.

	* setpci.c: Finished.

	* lspci.c: Now able to fetch expansion ROM base from kernel device list
	and print it if not in buscentric mode.

Tue Mar 31 23:11:57 1998  Martin Mares  <mj@albireo.ucw.cz>

	* setpci.c: Added.

Sun Mar 22 15:39:08 1998  Martin Mares  <mj@albireo.ucw.cz>

	* lspci.8: Updated the documentation.

	* lspci.c: Modified to use the new filtering mechanism (options -f and -d).

	* filter.c: Introduced new generic device filter.

Thu Mar 19 17:03:48 1998  Martin Mares  <mj@lomikel.karlin.mff.cuni.cz>

	* lspci.c (grow_tree, show_tree_dev, print_it): Fixed displaying
	of PCI-to-PCI bridges in the tree format.

Sun Feb 15 10:12:25 1998  Martin Mares  <mj@albireo.ucw.cz>

	* lspci.c (show_machine): Added non-verbose mode of machine-readable
	dump.

	* pci.ids: Updates from Jens Maurer.

	* Released as version 1.02.

Thu Feb 12 16:53:28 1998  Martin Mares  <mj@lomikel.karlin.mff.cuni.cz>

	* lspci.c: Added a "-m" switch for dumping machine-readable
	configuration data (requested by Bjoern Kriews <bkr@cut.de>).

Mon Feb  9 13:17:43 1998  Martin Mares  <mj@albireo.ucw.cz>

	* Makefile, pciutils.h: Include local pci.h instead of <linux/pci.h>
	if available. This should avoid all problems with official kernel
	not synchronized to newer PCI code in CVS -- standard distribution
	of pciutils now contains pci.h from current CVS kernel, pciutils
	in CVS contain no pci.h and use the correct kernel include.

	* Makefile: Fixed installation path for man pages.

Sat Feb  7 15:15:46 1998  Martin Mares  <mj@albireo.ucw.cz>

	* README: Updated.

	* lspci.8: Created a man page.

	* Releasing as version 1.0.

Tue Feb  3 20:56:00 1998  Martin Mares  <mj@albireo.ucw.cz>

	* Makefile: Recognize architecture by calling uname and pass it as ARCH_xxx
	to all the C sources. This should eliminate problems with 32-bit compilers
	on sparc64.

	* lspci.c (show_verbose): Recognize CardBus bridge header type.
	(show_htype2): Stub routine.
	(scan_config): Write sensible error message if the kernel denies reading of
	upper part of the PCI config space.
